<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>é•¿æ²™æ—…æ¸¸åŠ©æ‰‹</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://unpkg.com/jspdf-font/ttfsimsun/simsun-normal.js"></script>

    <style>
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            background: #f7f7f7;
            margin: 0;
            padding: 20px;
            color: #333;
        }

        h1 {
            text-align: center;
            color: #e74c3c;
            margin-bottom: 30px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: #fff;
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.1);
        }

        select,
        button {
            padding: 12px 15px;
            margin: 10px 5px 20px 0;
            font-size: 16px;
            border-radius: 6px;
            border: 1px solid #ddd;
        }

        button {
            background-color: #e67e22;
            border: none;
            color: white;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #d35400;
        }

        button.secondary {
            background-color: #3498db;
        }

        button.secondary:hover {
            background-color: #2980b9;
        }

        button.tertiary {
            background-color: #2ecc71;
        }

        button.tertiary:hover {
            background-color: #27ae60;
        }

        .plan-day {
            margin-bottom: 30px;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 6px;
        }

        .time-slot {
            margin-bottom: 15px;
        }

        .attraction-card {
            display: inline-block;
            width: 200px;
            margin: 10px;
            padding: 15px;
            background: white;
            border-radius: 6px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: transform 0.2s;
        }

        .attraction-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        .attraction-card.selected {
            background: #e8f4fc;
            border: 2px solid #3498db;
        }

        .attraction-card h4 {
            margin-top: 0;
            color: #e74c3c;
        }

        .hidden {
            display: none;
        }

        #planDisplay {
            margin-top: 30px;
        }

        .plan-item {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px dashed #ddd;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }

        @media (max-width: 600px) {
            .container {
                padding: 15px;
            }

            .attraction-card {
                width: 100%;
                margin: 10px 0;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>é•¿æ²™æ—…æ¸¸åŠ©æ‰‹ ğŸŒ¶ï¸</h1>

        <!-- ç¬¬ä¸€æ­¥ï¼šé€‰æ‹©å¤©æ•° -->
        <div id="step1">
            <h2>ç¬¬ä¸€æ­¥ï¼šé€‰æ‹©æ—…æ¸¸å¤©æ•°</h2>
            <select id="daySelect">
                <option value="1">1 å¤©</option>
                <option value="2">2 å¤©</option>
                <option value="3">3 å¤©</option>
            </select>
            <button onclick="startPlanning()">å¼€å§‹è§„åˆ’</button>
        </div>

        <!-- ç¬¬äºŒæ­¥ï¼šè§„åˆ’æ¯å¤©è¡Œç¨‹ -->
        <div id="step2" class="hidden">
            <h2 id="currentDayTitle">ç¬¬1å¤©è¡Œç¨‹è§„åˆ’</h2>
            <div id="dayPlans"></div>
            <div class="navigation">
                <button id="prevDayBtn" class="secondary hidden" onclick="prevDay()">â† ä¸Šä¸€å¤©</button>
                <button id="nextDayBtn" class="tertiary" onclick="nextDay()">ä¸‹ä¸€æ—¥ â†’</button>
            </div>
        </div>

        <!-- ç¬¬ä¸‰æ­¥ï¼šæŸ¥çœ‹æœ€ç»ˆè¡Œç¨‹ -->
        <div id="step3" class="hidden">
            <h2>æ‚¨çš„é•¿æ²™æ—…æ¸¸è¡Œç¨‹</h2>
            <div id="planDisplay"></div>
            <div class="navigation">
                <button class="secondary" onclick="backToPlanning()">è¿”å›ä¿®æ”¹</button>
                <button onclick="downloadPDF()">ğŸ“„ ä¸‹è½½ PDF è¡Œç¨‹å•</button>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
        // å®Œæ•´é•¿æ²™æ™¯ç‚¹æ•°æ®
        const changshaData = {
            morning: [
                {
                    name: "å²³éº“å±±",
                    description: "é•¿æ²™æ ‡å¿—æ€§æ™¯ç‚¹ï¼Œæµ·æ‹”300ç±³ï¼ŒåŒ…å«å²³éº“ä¹¦é™¢ã€çˆ±æ™šäº­ç­‰å¤è¿¹",
                    food: "ã€é™„è¿‘ç¾é£Ÿã€‘å¸…å“¥çƒ§é¥¼(éº“å±±å—è·¯)ã€å‘ç¾¤é”…é¥º(ç™»é«˜è·¯)"
                },
                {
                    name: "æ©˜å­æ´²å¤´",
                    description: "æ¹˜æ±Ÿä¸­çš„å¸¦çŠ¶å²›å±¿ï¼Œæ¯›æ³½ä¸œé’å¹´è‰ºæœ¯é›•å¡‘æ‰€åœ¨åœ°ï¼Œå‘¨æœ«æœ‰çƒŸèŠ±è¡¨æ¼”",
                    food: "ã€æ±Ÿæ™¯é¤å…ã€‘è€é•¿æ²™é¾™è™¾é¦†ã€æ¹˜æ±Ÿå¤§ç å¤´(æ¸”äººç å¤´åº—)"
                },
                {
                    name: "æ¹–å—çœåšç‰©é¦†",
                    description: "å›½å®¶ä¸€çº§åšç‰©é¦†ï¼Œé©¬ç‹å †æ±‰å¢“é™ˆåˆ—éå¸¸éœ‡æ’¼ï¼Œéœ€æå‰é¢„çº¦",
                    food: "ã€æ­¥è¡Œ5åˆ†é’Ÿã€‘åšç‰©é¦†é£Ÿå ‚ï¼šæ¯›æ°çº¢çƒ§è‚‰ã€å‰æ¤’é±¼å¤´"
                },
                {
                    name: "å¤©å¿ƒé˜",
                    description: "é•¿æ²™å¤åŸå¢™é—å€ï¼Œæ˜ä»£å»ºç­‘ï¼Œå¯ä¿¯ç°é•¿æ²™è€åŸåŒº",
                    food: "ã€é™„è¿‘ç¾é£Ÿã€‘æ¨è£•å…´é¢é¦†(ç™¾å¹´è€åº—)ã€åŒç‡•æ¥¼é¦„é¥¨"
                }
            ],
            noon: [
                {
                    name: "å¤ªå¹³è€è¡—",
                    description: "é•¿æ²™ä¿å­˜æœ€å®Œæ•´çš„å†å²è€è¡—ï¼Œé’çŸ³æ¿è·¯å’Œæ°‘å›½å»ºç­‘",
                    food: "ã€å¿…åƒå°åƒã€‘é»‘è‰²ç»å…¸è‡­è±†è…ã€é‚µç¦è®°æ¢…èœæ‰£è‚‰é¥¼"
                },
                {
                    name: "å¡å­è¡—",
                    description: "åƒå¹´å¤è¡—ï¼Œç«å®«æ®¿æ€»åº—æ‰€åœ¨åœ°ï¼Œæ°‘ä¿—è¡¨æ¼”ä¸°å¯Œ",
                    food: "ã€è€å­—å·ã€‘ç«å®«æ®¿(çº¢çƒ§è‚‰ã€å§Šå¦¹å›¢å­)ã€æ–°åæ¥¼(å‰Šé¢)"
                },
                {
                    name: "è¶…çº§æ–‡å’Œå‹",
                    description: "å¤å¤é•¿æ²™ç”Ÿæ´»åœºæ™¯ï¼Œ7å±‚æ¥¼çš„ç©ºé—´è¿˜åŸ1980å¹´ä»£å¸‚äº•æ–‡åŒ–",
                    food: "ã€æ‹›ç‰Œèœã€‘æ–‡å’Œå‹é¾™è™¾ã€çŒªæ²¹æ‹Œé¥­ã€ç´«è‹æ¡ƒå­å§œ"
                },
                {
                    name: "éƒ½æ­£è¡—",
                    description: "å°ä¼—æ–‡è‰ºè¡—åŒºï¼Œä¿ç•™æ˜æ¸…å»ºç­‘é£æ ¼ï¼Œäººæµé‡è¾ƒå°‘",
                    food: "ã€ç‰¹è‰²é¤å…ã€‘ç›Ÿé‡çƒ§çƒ¤ã€å®¢ä¸²å‡ºå“(æ˜æ˜Ÿæ‰“å¡åº—)"
                }
            ],
            evening: [
                {
                    name: "äº”ä¸€å¹¿åœº",
                    description: "é•¿æ²™å¸‚ä¸­å¿ƒåœ°æ ‡ï¼ŒIFSå›½é‡‘ä¸­å¿ƒ7æ¥¼ç½‘çº¢é›•å¡‘æ‰“å¡ç‚¹",
                    food: "ã€ç½‘çº¢é¤å…ã€‘ç‚ŠçƒŸæ—¶ä»£(å°ç‚’é»„ç‰›è‚‰)ã€ä¸€ç›ç¯(æ¹˜èœ)"
                },
                {
                    name: "é»„å…´è·¯æ­¥è¡Œè¡—",
                    description: "ä¸­å›½åå¤§æ­¥è¡Œè¡—ä¹‹ä¸€ï¼Œ3Dç«‹ä½“å¤§å±å’Œè¡—å¤´è¡¨æ¼”",
                    food: "ã€å¤œå®µã€‘å››å¨­æ¯‘å£å‘³è™¾ã€ä¼åšå¾·å ‚(æ°‘å›½å…¬é¦†èœ)"
                },
                {
                    name: "è§£æ”¾è¥¿è·¯é…’å§è¡—",
                    description: "é•¿æ²™å¤œç”Ÿæ´»ä¸­å¿ƒï¼Œæœ‰ä¼—å¤šlivehouseå’Œæ¸…å§",
                    food: "ã€é…’å§å°åƒã€‘COMMUNE(è‡ªé€‰é¤å§)ã€é…’ç‹¸èŠ±å›­(çƒ§çƒ¤)"
                },
                {
                    name: "æ¹˜æ±Ÿé£å…‰å¸¦",
                    description: "æ²¿æ±Ÿæ™¯è§‚é•¿å»Šï¼Œé€‚åˆæ•£æ­¥æ¬£èµé•¿æ²™å¤œæ™¯",
                    food: "ã€æ±Ÿè¾¹é¤å…ã€‘è€é•¿æ²™é¾™è™¾é¦†ã€æ¹˜æ±Ÿ36å·ç§æˆ¿èœ"
                }
            ]
        };

        let selectedDays = 1;
        let currentDay = 1;
        let selectedPlans = [];

        // å¼€å§‹è§„åˆ’
        function startPlanning() {
            selectedDays = parseInt(document.getElementById("daySelect").value);
            selectedPlans = Array(selectedDays).fill().map(() => ({
                morning: null,
                noon: null,
                evening: null
            }));

            document.getElementById("step1").classList.add("hidden");
            document.getElementById("step2").classList.remove("hidden");
            updateDayTitle();
            renderDayPlan(currentDay);
            updateNavigationButtons();
        }

        // æ›´æ–°å¯¼èˆªæŒ‰é’®çŠ¶æ€
        function updateNavigationButtons() {
            const prevBtn = document.getElementById("prevDayBtn");
            const nextBtn = document.getElementById("nextDayBtn");

            prevBtn.classList.toggle("hidden", currentDay === 1);

            if (currentDay === selectedDays) {
                nextBtn.textContent = "å®Œæˆè§„åˆ’ â†’";
                nextBtn.onclick = showFinalPlan;
            } else {
                nextBtn.textContent = "ä¸‹ä¸€æ—¥ â†’";
                nextBtn.onclick = nextDay;
            }
        }

        // æ›´æ–°å½“å‰å¤©æ•°æ ‡é¢˜
        function updateDayTitle() {
            document.getElementById("currentDayTitle").textContent = `ç¬¬${currentDay}å¤©è¡Œç¨‹è§„åˆ’`;
        }

        // ä¸Šä¸€å¤©
        function prevDay() {
            if (currentDay > 1) {
                currentDay--;
                updateDayTitle();
                renderDayPlan(currentDay);
                updateNavigationButtons();
            }
        }

        // ä¸‹ä¸€å¤©
        function nextDay() {
            if (currentDay < selectedDays) {
                currentDay++;
                updateDayTitle();
                renderDayPlan(currentDay);
                updateNavigationButtons();
            }
        }

        // æ¸²æŸ“æŸå¤©çš„è§„åˆ’ç•Œé¢
        function renderDayPlan(day) {
            const planDiv = document.getElementById("dayPlans");
            planDiv.innerHTML = "";

            const dayIndex = day - 1;

            // ä¸Šåˆé€‰æ‹©
            const morningDiv = document.createElement("div");
            morningDiv.className = "time-slot";
            morningDiv.innerHTML = `<h3>ğŸŒ… ä¸Šåˆè¡Œç¨‹</h3>`;
            changshaData.morning.forEach(attraction => {
                const card = createAttractionCard(attraction, "morning", dayIndex);
                morningDiv.appendChild(card);
            });
            planDiv.appendChild(morningDiv);

            // ä¸­åˆé€‰æ‹©
            const noonDiv = document.createElement("div");
            noonDiv.className = "time-slot";
            noonDiv.innerHTML = `<h3>ğŸ½ï¸ ä¸­åˆè¡Œç¨‹</h3>`;
            changshaData.noon.forEach(attraction => {
                const card = createAttractionCard(attraction, "noon", dayIndex);
                noonDiv.appendChild(card);
            });
            planDiv.appendChild(noonDiv);

            // æ™šä¸Šé€‰æ‹©
            const eveningDiv = document.createElement("div");
            eveningDiv.className = "time-slot";
            eveningDiv.innerHTML = `<h3>ğŸŒƒ æ™šä¸Šè¡Œç¨‹</h3>`;
            changshaData.evening.forEach(attraction => {
                const card = createAttractionCard(attraction, "evening", dayIndex);
                eveningDiv.appendChild(card);
            });
            planDiv.appendChild(eveningDiv);

            // æ˜¾ç¤ºå½“å‰é€‰æ‹©
            const currentDiv = document.createElement("div");
            currentDiv.innerHTML = `
                <h3>å½“å‰é€‰æ‹©</h3>
                <p>ä¸Šåˆ: ${selectedPlans[dayIndex].morning ? selectedPlans[dayIndex].morning.name : "æœªé€‰æ‹©"}</p>
                <p>ä¸­åˆ: ${selectedPlans[dayIndex].noon ? selectedPlans[dayIndex].noon.name : "æœªé€‰æ‹©"}</p>
                <p>æ™šä¸Š: ${selectedPlans[dayIndex].evening ? selectedPlans[dayIndex].evening.name : "æœªé€‰æ‹©"}</p>
            `;
            planDiv.appendChild(currentDiv);
        }

        // åˆ›å»ºæ™¯ç‚¹å¡ç‰‡
        function createAttractionCard(attraction, timeSlot, dayIndex) {
            const card = document.createElement("div");
            card.className = "attraction-card";
            if (selectedPlans[dayIndex][timeSlot] && selectedPlans[dayIndex][timeSlot].name === attraction.name) {
                card.classList.add("selected");
            }

            card.innerHTML = `
                <h4>${attraction.name}</h4>
                <p>${attraction.description}</p>
                <p><small>${attraction.food}</small></p>
            `;

            card.onclick = () => {
                selectedPlans[dayIndex][timeSlot] = attraction;
                renderDayPlan(currentDay);
            };

            return card;
        }

        // æ˜¾ç¤ºæœ€ç»ˆè¡Œç¨‹
        function showFinalPlan() {
            document.getElementById("step2").classList.add("hidden");
            document.getElementById("step3").classList.remove("hidden");

            const planDiv = document.getElementById("planDisplay");
            planDiv.innerHTML = "";

            selectedPlans.forEach((dayPlan, index) => {
                const dayDiv = document.createElement("div");
                dayDiv.className = "plan-day";
                dayDiv.innerHTML = `
                    <h3>ğŸ“… ç¬¬ ${index + 1} å¤©</h3>
                    <div class="plan-item">
                        <h4>ğŸŒ… ä¸Šåˆ: ${dayPlan.morning ? dayPlan.morning.name : "æœªå®‰æ’"}</h4>
                        <p>${dayPlan.morning ? dayPlan.morning.description : ""}</p>
                        <p><em>${dayPlan.morning ? dayPlan.morning.food : ""}</em></p>
                    </div>
                    <div class="plan-item">
                        <h4>ğŸ½ï¸ ä¸­åˆ: ${dayPlan.noon ? dayPlan.noon.name : "æœªå®‰æ’"}</h4>
                        <p>${dayPlan.noon ? dayPlan.noon.description : ""}</p>
                        <p><em>${dayPlan.noon ? dayPlan.noon.food : ""}</em></p>
                    </div>
                    <div class="plan-item">
                        <h4>ğŸŒƒ æ™šä¸Š: ${dayPlan.evening ? dayPlan.evening.name : "æœªå®‰æ’"}</h4>
                        <p>${dayPlan.evening ? dayPlan.evening.description : ""}</p>
                        <p><em>${dayPlan.evening ? dayPlan.evening.food : ""}</em></p>
                    </div>
                    <hr/>
                `;
                planDiv.appendChild(dayDiv);
            });
        }

        // è¿”å›ä¿®æ”¹è¡Œç¨‹
        function backToPlanning() {
            document.getElementById("step3").classList.add("hidden");
            document.getElementById("step2").classList.remove("hidden");
            updateDayTitle();
            renderDayPlan(currentDay);
            updateNavigationButtons();
        }

        // ä¸‹è½½PDF
        function downloadPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            // æ³¨å†Œ SimSun å­—ä½“
            doc.addFileToVFS("simsun.ttf", simsunFont);  // simsunFont æ˜¯æ’ä»¶æä¾›çš„
            doc.addFont("simsun.ttf", "simsun", "normal");
            doc.setFont("simsun");  // åˆ‡æ¢ä¸ºä¸­æ–‡å­—ä½“

            // å‰©ä¸‹çš„å†…å®¹ä¿æŒä¸å˜
            doc.setFontSize(18);
            doc.setTextColor(231, 76, 60);
            doc.text("é•¿æ²™æ—…æ¸¸è¡Œç¨‹è®¡åˆ’", 105, 15, { align: "center" });

            doc.setFontSize(12);
            doc.setTextColor(0, 0, 0);
            doc.text(`è¡Œç¨‹å¤©æ•°: ${selectedDays}å¤© | ç”Ÿæˆæ—¶é—´: ${new Date().toLocaleString("zh-CN")}`, 105, 22, { align: "center" });

            let y = 35;
            selectedPlans.forEach((dayPlan, index) => {
                doc.setFontSize(14);
                doc.setTextColor(231, 76, 60);
                doc.text(`ç¬¬ ${index + 1} å¤©`, 20, y);
                doc.setTextColor(0, 0, 0);
                y += 8;

                doc.setFontSize(12);
                if (dayPlan.morning) {
                    doc.text(`ğŸŒ… ä¸Šåˆ: ${dayPlan.morning.name}`, 20, y);
                    y += 7;
                    doc.text(`   ${dayPlan.morning.description}`, 20, y);
                    y += 7;
                    doc.text(`   ${dayPlan.morning.food}`, 20, y);
                    y += 10;
                }
                if (dayPlan.noon) {
                    doc.text(`ğŸ½ï¸ ä¸­åˆ: ${dayPlan.noon.name}`, 20, y);
                    y += 7;
                    doc.text(`   ${dayPlan.noon.description}`, 20, y);
                    y += 7;
                    doc.text(`   ${dayPlan.noon.food}`, 20, y);
                    y += 10;
                }
                if (dayPlan.evening) {
                    doc.text(`ğŸŒƒ æ™šä¸Š: ${dayPlan.evening.name}`, 20, y);
                    y += 7;
                    doc.text(`   ${dayPlan.evening.description}`, 20, y);
                    y += 7;
                    doc.text(`   ${dayPlan.evening.food}`, 20, y);
                    y += 15;
                }

                if (index < selectedPlans.length - 1) {
                    doc.line(20, y, 190, y);
                    y += 10;
                }
            });

            doc.setFontSize(10);
            doc.text("Created by é•¿æ²™æ—…æ¸¸åŠ©æ‰‹", 190, 285, { align: "right" });

            doc.save(`é•¿æ²™${selectedDays}æ—¥æ¸¸è¡Œç¨‹.pdf`);
        }


        function resetPlanner() {
            document.getElementById("step3").classList.add("hidden");
            document.getElementById("step1").classList.remove("hidden");
            currentDay = 1;
        }
    </script>
</body>

</html>